(function(){var e="cmp";
var o="search";
var b=300;
var k=300;
var c="resultsOffset";
var i={TAB:9,ENTER:13,ESCAPE:27,ARROW_UP:38,ARROW_DOWN:40};
var l={self:"[data-"+e+'-is="'+o+'"]',item:{self:"[data-"+e+"-hook-"+o+'="item"]',title:"[data-"+e+"-hook-"+o+'="itemTitle"]',focused:"."+e+"-search__item--is-focused"}};
var j={minLength:{"default":3,transform:function(p){p=parseFloat(p);
return isNaN(p)?null:p
}},resultsSize:{"default":10,transform:function(p){p=parseFloat(p);
return isNaN(p)?null:p
}}};
var m=0;
function a(s){var u=s.dataset;
var q=[];
var v=o;
v=v.charAt(0).toUpperCase()+v.slice(1);
var p=["is","hook"+v];
for(var r in u){if(u.hasOwnProperty(r)){var t=u[r];
if(r.indexOf(e)===0){r=r.slice(e.length);
r=r.charAt(0).toLowerCase()+r.substring(1);
if(p.indexOf(r)===-1){q[r]=t
}}}}return q
}function h(q,p){if(q){if(p!==false){q.style.display="block";
q.setAttribute("aria-hidden",false)
}else{q.style.display="none";
q.setAttribute("aria-hidden",true)
}}}function n(r){var s=[];
if(r&&r.elements){for(var p=0;
p<r.elements.length;
p++){var q=r.elements[p];
if(!q.disabled&&q.name){var t=[q.name,encodeURIComponent(q.value)];
s.push(t.join("="))
}}}return s.join("&")
}function f(u,t){if(!u||!t){return
}if(u.nodeType===3){var q=u.nodeValue;
var p=t.exec(q);
if(q&&p){var s=document.createElement("mark");
s.className=e+"-search__item-mark";
s.appendChild(document.createTextNode(p[0]));
var v=u.splitText(p.index);
v.nodeValue=v.nodeValue.substring(p[0].length);
u.parentNode.insertBefore(s,v)
}}else{if(u.hasChildNodes()){for(var r=0;
r<u.childNodes.length;
r++){f(u.childNodes[r],t)
}}}}function d(p){if(p.element){p.element.removeAttribute("data-"+e+"-is")
}this._cacheElements(p.element);
this._setupProperties(p.options);
this._action=this._elements.form.getAttribute("action");
this._resultsOffset=0;
this._hasMoreResults=true;
this._elements.input.addEventListener("input",this._onInput.bind(this));
this._elements.input.addEventListener("focus",this._onInput.bind(this));
this._elements.input.addEventListener("keydown",this._onKeydown.bind(this));
this._elements.clear.addEventListener("click",this._onClearClick.bind(this));
document.addEventListener("click",this._onDocumentClick.bind(this));
this._elements.results.addEventListener("scroll",this._onScroll.bind(this));
this._makeAccessible()
}d.prototype._displayResults=function(){if(this._elements.input.value.length===0){h(this._elements.clear,false);
this._cancelResults()
}else{if(this._elements.input.value.length<this._properties.minLength){h(this._elements.clear,true)
}else{this._updateResults();
h(this._elements.clear,true)
}}};
d.prototype._onScroll=function(p){if(this._elements.results.scrollTop+2*this._elements.results.clientHeight>=this._elements.results.scrollHeight){this._resultsOffset+=this._properties.resultsSize;
this._displayResults()
}};
d.prototype._onInput=function(q){var p=this;
p._cancelResults();
this._timeout=setTimeout(function(){p._displayResults()
},b)
};
d.prototype._onKeydown=function(q){var p=this;
switch(q.keyCode){case i.TAB:if(p._resultsOpen()){q.preventDefault()
}break;
case i.ENTER:q.preventDefault();
if(p._resultsOpen()){var r=p._elements.results.querySelector(l.item.focused);
if(r){r.click()
}}break;
case i.ESCAPE:p._cancelResults();
break;
case i.ARROW_UP:if(p._resultsOpen()){q.preventDefault();
p._stepResultFocus(true)
}break;
case i.ARROW_DOWN:if(p._resultsOpen()){q.preventDefault();
p._stepResultFocus()
}else{p._onInput()
}break;
default:return
}};
d.prototype._onClearClick=function(p){p.preventDefault();
this._elements.input.value="";
h(this._elements.clear,false);
h(this._elements.results,false)
};
d.prototype._onDocumentClick=function(q){var r=this._elements.input.contains(q.target);
var p=this._elements.results.contains(q.target);
if(!(r||p)){h(this._elements.results,false)
}};
d.prototype._resultsOpen=function(){return this._elements.results.style.display!=="none"
};
d.prototype._makeAccessible=function(){var p=e+"-search-results-"+m;
this._elements.input.setAttribute("aria-owns",p);
this._elements.results.id=p;
m++
};
d.prototype._generateItems=function(r,q){var p=this;
r.forEach(function(t){var s=document.createElement("span");
s.innerHTML=p._elements.itemTemplate.innerHTML;
s.querySelectorAll(l.item.title)[0].appendChild(document.createTextNode(t.title));
s.querySelectorAll(l.item.self)[0].setAttribute("href",t.url);
q.innerHTML+=s.innerHTML
})
};
d.prototype._markResults=function(){var r=this._elements.results.querySelectorAll(l.item.self);
var q=this._elements.input.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");
var t=new RegExp("("+q+")","gi");
for(var s=this._resultsOffset-1;
s<r.length;
++s){var p=r[s];
f(p,t)
}};
d.prototype._stepResultFocus=function(r){var t=this._elements.results.querySelectorAll(l.item.self);
var v=this._elements.results.querySelector(l.item.focused);
var q;
var p=Array.prototype.indexOf.call(t,v);
var u=e+"-search__item--is-focused";
if(t.length>0){if(!r){if(p<0){t[0].classList.add(u)
}else{if(p+1<t.length){t[p].classList.remove(u);
t[p+1].classList.add(u)
}}q=this._elements.results.querySelector(l.item.focused);
if(q){var w=q.offsetTop+q.offsetHeight-this._elements.results.scrollTop-this._elements.results.clientHeight;
if(w>0){this._elements.results.scrollTop+=w
}else{this._onScroll()
}}}else{if(p>=1){t[p].classList.remove(u);
t[p-1].classList.add(u)
}q=this._elements.results.querySelector(l.item.focused);
if(q){var s=this._elements.results.scrollTop-q.offsetTop;
if(s>0){this._elements.results.scrollTop-=s
}}}}};
d.prototype._updateResults=function(){var p=this;
if(p._hasMoreResults){var r=new XMLHttpRequest();
var q=p._action+"?"+n(p._elements.form)+"&"+c+"="+p._resultsOffset;
r.open("GET",q,true);
r.onload=function(){setTimeout(function(){h(p._elements.loadingIndicator,false);
h(p._elements.icon,true)
},k);
if(r.status>=200&&r.status<400){var s=JSON.parse(r.responseText);
if(s.length>0){p._generateItems(s,p._elements.results);
p._markResults();
h(p._elements.results,true)
}else{p._hasMoreResults=false
}if(p._elements.results.querySelectorAll(l.item.self).length%p._properties.resultsSize>0){p._hasMoreResults=false
}}else{}};
h(p._elements.loadingIndicator,true);
h(p._elements.icon,false);
r.send()
}};
d.prototype._cancelResults=function(){clearTimeout(this._timeout);
this._elements.results.scrollTop=0;
this._resultsOffset=0;
this._hasMoreResults=true;
this._elements.results.innerHTML=""
};
d.prototype._cacheElements=function(u){this._elements={};
this._elements.self=u;
var p=this._elements.self.querySelectorAll("[data-"+e+"-hook-"+o+"]");
for(var r=0;
r<p.length;
r++){var s=p[r];
var t=o;
t=t.charAt(0).toUpperCase()+t.slice(1);
var q=s.dataset[e+"Hook"+t];
this._elements[q]=s
}};
d.prototype._setupProperties=function(p){this._properties={};
for(var q in j){if(j.hasOwnProperty(q)){var r=j[q];
if(p&&p[q]!=null){if(r&&typeof r.transform==="function"){this._properties[q]=r.transform(p[q])
}else{this._properties[q]=p[q]
}}else{this._properties[q]=j[q]["default"]
}}}};
function g(){var t=document.querySelectorAll(l.self);
for(var r=0;
r<t.length;
r++){new d({element:t[r],options:a(t[r])})
}var s=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;
var p=document.querySelector("body");
var q=new s(function(u){u.forEach(function(v){var w=[].slice.call(v.addedNodes);
if(w.length>0){w.forEach(function(x){if(x.querySelectorAll){var y=[].slice.call(x.querySelectorAll(l.self));
y.forEach(function(z){new d({element:z,options:a(z)})
})
}})
}})
});
q.observe(p,{subtree:true,childList:true,characterData:true})
}if(document.readyState!=="loading"){g()
}else{document.addEventListener("DOMContentLoaded",g)
}})();